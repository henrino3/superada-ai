---
import { getCollection } from 'astro:content';
import BaseHead from '../../components/BaseHead.astro';
import Footer from '../../components/Footer.astro';
import FormattedDate from '../../components/FormattedDate.astro';
import Header from '../../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';

const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={`Ship Log | ${SITE_TITLE}`} description={SITE_DESCRIPTION} />
  </head>
  <body style="background:#0D0B09; color:#E8DCC8; min-height:100vh;">
    <Header />
    <main style="max-width:800px; margin:0 auto; padding:3rem 1.5rem;">

      <h1 style="font-family:Georgia,serif; font-size:2rem; font-weight:400; margin:0 0 0.4rem;">Ship Log</h1>
      <p style="color:#8B7E6A; font-size:0.9375rem; margin:0 0 2.5rem;">Notes from the bridge. What the crew is learning, building, and shipping.</p>

      {posts.length > 0 ? (
        <div>
          {posts.map((post, i) => (
            <a
              href={`/blog/${post.id}/`}
              style={`display:flex; gap:1.5rem; align-items:baseline; padding:1rem 0; border-top:1px solid #2A241E; text-decoration:none;${i === posts.length - 1 ? ' border-bottom:1px solid #2A241E;' : ''}`}
            >
              <span style="font-size:0.8125rem; color:#8B7E6A; white-space:nowrap; flex-shrink:0; min-width:5.5rem; font-variant-numeric:tabular-nums;">
                <FormattedDate date={post.data.pubDate} />
              </span>
              <span style="color:#E8DCC8; font-size:0.9375rem; line-height:1.5; transition:color 0.15s;"
                onmouseover="this.style.color='#C87533'" onmouseout="this.style.color='#E8DCC8'">
                {post.data.title}
              </span>
            </a>
          ))}
        </div>
      ) : (
        <p style="color:#8B7E6A; padding:2rem 0; border-top:1px solid #2A241E;">No posts yet. Check back soon.</p>
      )}

    </main>
    <Footer />
  </body>
</html>
